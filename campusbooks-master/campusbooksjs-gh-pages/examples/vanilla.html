<!DOCTYPE HTML>
<html>
  <head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <title>CampusBooksJS: Auto-generated Documentation</title>
    <script src="../lib/campusbooks.all.js"></script>
  </head>
  <body>
    <form id="vanilla-campusbooksjs-form">
      <select name="cb_search">
        <option>keywords</option>
        <option>author</option>
        <option>isbn</option>
      </select>
      : <input name="cb_value" type="text"/>
      <input type="submit" value="Search"/>
    </form>
    <div>
      <pre>
        <code id="vanilla-campusbooksjs-display">
        </code>
      </pre>
    </div>
  </body>
  <script>
    // Vanilla JS Example: CampusBooksJS
    (function () {
      var CampusBooks = require('campusbooks'),
        // This key is a special dummy key from CampusBooks for public testing purposes 
        // Note that it only works with Half.com, not the other 20 textbook sites, so it's not very useful,
        // but good enough for this demo
        cb = CampusBooks.create("BDz21GvuL6RgTKiSbwe3"),
        cbform = document.getElementById("vanilla-campusbooksjs-form");


      // Note: This is for demonstration purposes only (with modern browsers)
      // Use MooTools or jQuery for a real-world solution that works cross-browser
      // (and please don't write you own, it's not worth it)
      function cbSearch(e) {
        var cbform = this,
          search = cbform.querySelector("select").value,
          data = cbform.querySelector("input").value;

        e.preventDefault();

        if (!data) {
          alert("Try Typing in a Keyword or Two First");
          return;
        }
        alert("Your Search: " + search + ": " +  JSON.stringify(data, null, '  '));

        var params = {};
        params[search] = data;
        cb.search(params).when(function (err, nativeHttpClient, data) {
          if (err || !data) {
            alert("Error: " + JSON.stringify(err) || "No Data Returned");
            return;
          }
          document.querySelectorAll("#vanilla-campusbooksjs-display")[0].innerHTML = JSON.stringify(data, null, '  ');
        });
      }

      // This will work on modern browsers only
      cbform.addEventListener("submit", cbSearch, false);
    }());
  </script>
</html>
